<!doctype html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Dashboard | WinPost</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@800&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="/css/estilo.css">
</head>

<body class="d-flex flex-column min-vh-100 bg-light">

    <div th:replace="~{fragments/navbar :: navbar}"></div>
    

    <div style="margin-top: 80px;"></div>

    <main class="flex-grow-1" id="wrapper">
        <div class="container-fluid px-4 mb-5">
            <div class="row justify-content-center">
                <div class="col-xl-10 col-12"> <div class="d-flex justify-content-between align-items-center mb-4 mt-4">
                        <div class="d-flex align-items-center ps-3 border-start border-4 border-primary">
                            <button class="btn btn-sm btn-outline-primary d-lg-none me-3" type="button" 
                                    data-bs-toggle="offcanvas" data-bs-target="#sidebarMenu">
                                <i class="fa-solid fa-bars"></i>
                            </button>

                            <div>
                                <h2 class="fw-bold text-dark mb-0 h3">Dashboard</h2>
                                <p class="text-muted mb-0 small">Visão geral e métricas do sistema.</p>
                            </div>
                        </div>
                        
                       
                    </div>

                    <div class="row mb-5 g-3">
                        <div class="col-md-4">
                            <div class="card card-modern shadow-sm border-0 h-100">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-uppercase text-muted fw-bold mb-1" style="font-size: 0.75rem;">Total de Contatos</h6>
                                            <h2 class="fw-bold mb-0 text-dark" th:text="${totalContatos} ?: '0'">0</h2>
                                        </div>
                                        <div class="bg-primary bg-opacity-10 text-white rounded-circle p-3 d-flex align-items-center justify-content-center" style="width: 50px; height: 50px;">
                                            <i class="fa-solid fa-users fs-5"></i>
                                        </div>
                                    </div>
                                    <small class="text-success fw-bold mt-3 d-block small">
                                        <i class="fa-solid fa-arrow-up me-1"></i> Base ativa
                                    </small>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="card card-modern shadow-sm border-0 h-100">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-uppercase text-muted fw-bold mb-1" style="font-size: 0.75rem;">Novo Cadastro</h6>
                                            <p class="text-muted small mb-0">Adicionar registro</p>
                                        </div>
                                        <div class="bg-success bg-opacity-10 text-white rounded-circle p-3 d-flex align-items-center justify-content-center" style="width: 50px; height: 50px;">
                                            <i class="fa-solid fa-user-plus fs-5"></i>
                                        </div>
                                    </div>
                                    <a href="/cadastroContatos" class="btn btn-sm btn-outline-success w-100 mt-3 rounded-pill fw-bold">
                                        Ir para Cadastro <i class="fa-solid fa-arrow-right ms-1"></i>
                                    </a>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="card card-modern shadow-sm border-0 h-100">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="text-uppercase text-muted fw-bold mb-1" style="font-size: 0.75rem;">Status Sistema</h6>
                                            <h5 class="fw-bold mb-0 text-success">Online</h5>
                                        </div>
                                        <div class="bg-info bg-opacity-10 text-white rounded-circle p-3 d-flex align-items-center justify-content-center" style="width: 50px; height: 50px;">
                                            <i class="fa-solid fa-server fs-5"></i>
                                        </div>
                                    </div>
                                    <small class="text-muted mt-3 d-block small">Versão 1.0.0</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-12">
                            <div class="card card-modern shadow-sm border-0 h-100">
                                <div class="card-header bg-white py-3 border-bottom-0">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <h6 class="m-0 fw-bold text-dark">
                                            <i class="fa-solid fa-clock-rotate-left me-2 text-primary"></i>Últimos Cadastrados
                                        </h6>
                                        <span class="badge bg-light text-muted border rounded-pill px-3">Recentes</span>
                                    </div>
                                </div>
                                <div class="card-body p-0">
                                    <div class="table-responsive">
                                        <table class="table table-hover align-middle mb-0">
                                            <thead class="bg-light">
                                                <tr>
                                                    <th class="ps-4 text-secondary small fw-bold text-uppercase py-3">Nome</th>
                                                    <th class="text-secondary small fw-bold text-uppercase py-3">Email</th>
                                                    <th class="text-secondary small fw-bold text-uppercase py-3">Data</th>
                                                    <th class="text-end pe-4 text-secondary small fw-bold text-uppercase py-3">Ação</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr th:if="${ultimosContatos == null or #lists.isEmpty(ultimosContatos)}">
                                                    <td colspan="4" class="text-center py-5 text-muted">
                                                        <i class="fa-regular fa-folder-open fs-4 mb-2 d-block opacity-50"></i>
                                                        Nenhum contato recente encontrado.
                                                    </td>
                                                </tr>
                                                <tr th:each="contato : ${ultimosContatos}">
                                                    <td class="ps-4">
                                                        <span class="fw-bold text-dark" th:text="${contato.nome}">Nome</span>
                                                    </td>
                                                    <td class="text-muted small" th:text="${contato.email}">email@exemplo.com</td>
                                                    <td>
                                                        <span class="badge bg-light text-dark border fw-normal" 
                                                              th:text="${contato.dataCadastro != null ? #temporals.format(contato.dataCadastro, 'dd/MM/yyyy') : '-'}">
                                                            01/01/2024
                                                        </span>
                                                    </td>
                                                    <td class="text-end pe-4">
                                                        <a th:href="@{/editarContatos/{id}(id=${contato.id})}" 
                                                           class="btn btn-sm btn-light text-primary border shadow-sm rounded-pill px-3"
                                                           title="Editar">
                                                           <i class="fa-solid fa-pen me-1"></i> Editar
                                                        </a>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="card-footer bg-white text-center py-3 border-top-0">
                                    <a href="/listarContatos" class="btn btn-outline-primary rounded-pill px-4 fw-bold small">
                                        Ver todos os contatos
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                </div> </div>
        </div>
    </main>

    <div class="modal fade" id="modalRelatorio" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="modalLabel"><i class="fa-solid fa-filter me-2"></i>Filtrar Relatório</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form action="/relatorio/pdf" method="get" target="_blank">
                    <div class="modal-body">
                        <div class="alert alert-light border shadow-sm small mb-3">Deixe em branco para todos os registros.</div>
                        <div class="mb-3">
                            <label for="filtroNome" class="form-label fw-bold small text-secondary">NOME</label>
                            <input type="text" class="form-control" name="nome" id="filtroNome">
                        </div>

                        <div class="row g-2" th:if="${listaEstados != null}">
                            <div class="col-md-8">
                                <label for="filtroCidade" class="form-label fw-bold small text-secondary">CIDADE</label>
                                <input type="text" class="form-control" name="cidade" id="filtroCidade">
                            </div>
                            <div class="col-md-4">
                                <label for="filtroEstado" class="form-label fw-bold small text-secondary">UF</label>
                                <select class="form-select" name="estado" id="filtroEstado">
                                    <option value="">Todas</option>
                                    <option th:each="uf : ${listaEstados}" th:value="${uf.name()}" th:text="${uf.descricao} ?: ${uf.name()}"></option>
                                </select>
                            </div>
                        </div>
                        <div class="alert alert-danger small" th:if="${listaEstados == null}">
                            Erro: Lista de estados não carregada.
                        </div>

                        <hr class="text-muted">
                        <p class="small fw-bold text-secondary mb-2">PERÍODO</p>
                        <div class="row g-2">
                            <div class="col-6"><label class="form-label small text-muted">De:</label><input type="date" class="form-control" name="dataInicio"></div>
                            <div class="col-6"><label class="form-label small text-muted">Até:</label><input type="date" class="form-control" name="dataFim"></div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                        <button type="submit" class="btn btn-success fw-bold"><i class="fa-solid fa-file-pdf me-2"></i> Gerar PDF</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>

    <div class="footer" th:replace="~{fragments/footer :: footer}"></div>

</body>
</html>